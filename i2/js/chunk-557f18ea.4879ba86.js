(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-557f18ea"],{"3fcc":function(e,t,r){"use strict";var i=r("ffcd"),o=r.n(i);o.a},"7b06":function(e,t,r){},a795:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"bg"},[r("div",{staticStyle:{color:"#ffffff","margin-bottom":"20px","font-size":"18px"}},[r("span",[e._v(e._s(e.oper))])]),r("el-form",{ref:"ticketForm",staticClass:"ticket",attrs:{model:e.ticketForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{staticClass:"color",attrs:{label:"电话号码",prop:"phone"}},[r("el-input",{model:{value:e.ticketForm.phone,callback:function(t){e.$set(e.ticketForm,"phone",t)},expression:"ticketForm.phone"}})],1),r("el-form-item",{attrs:{label:"机主姓名",prop:"name"}},[r("el-input",{model:{value:e.ticketForm.name,callback:function(t){e.$set(e.ticketForm,"name",t)},expression:"ticketForm.name"}})],1),r("el-form-item",{attrs:{label:"案件名称",prop:"case"}},[r("el-input",{model:{value:e.ticketForm.case,callback:function(t){e.$set(e.ticketForm,"case",t)},expression:"ticketForm.case"}})],1),r("el-form-item",{attrs:{label:"案件描述",prop:"depict"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ticketForm.depict,callback:function(t){e.$set(e.ticketForm,"depict",t)},expression:"ticketForm.depict"}})],1),r("el-form-item",{attrs:{label:"上传话单",prop:"uploadPhone"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadURL,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeUpload,"on-error":e.uploadError,"on-success":e.uploadSuccess,limit:1,"on-exceed":e.handleExceed,"auto-upload":!1}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件\n          ")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传Excel文件")])],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){"新建话单"==e.oper?e.submitForm("ticketForm"):"编辑话单"==e.oper?e.ticketAlter("ticketForm"):e.ticketAddTo("ticketForm")}}},[e._v("保存\n        ")]),r("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.resetForm("ticketForm")}}},[e._v("重置\n        ")])],1)],1)],1)])},o=[],s=(r("7cfd"),{inject:["reload"],data:function(){return{uploadURL:"http://192.168.1.186:90/statement/importEmp",ticketForm:{name:"",phone:"",case:"",depict:"",uploadPhone:"",flag:"",id:"",recordId:"",time:""},oper:"新建话单",rules:{name:[{required:!0,message:"请输入机主姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],phone:this.filter_rules({required:!0,type:"mobile"}),case:this.filter_rules({required:!0,min:2,max:10,type:"caseName"}),uploadPhone:"编辑话单"===this.oper?this.filter_rules({required:!1}):this.filter_rules({required:!0})}}},mounted:function(){void 0!==this.$route.query.phoneDataList&&this.getRoute()},methods:{getRoute:function(){var e=JSON.parse(this.$route.query.phoneDataList);this.ticketForm.name=e.name,this.ticketForm.phone=e.phone,this.ticketForm.case=e.caseName,this.ticketForm.recordId=e.recordId,this.ticketForm.depict=e.depict,this.oper=this.$route.query.oper,this.editoRrules()},editoRrules:function(){"新建话单"===this.oper?this.rules.uploadPhone=this.filter_rules({required:!0}):this.rules.uploadPhone=this.filter_rules({required:!1})},submitForm:function(e){var t=this;this.submitUpload();var r=this;this.$refs[e].validate((function(e){if(!e)return!1;var i={name:t.ticketForm.name,phone:t.ticketForm.phone,caseName:t.ticketForm.case,desc:t.ticketForm.depict,flag:t.ticketForm.flag,id:t.ticketForm.id,recordId:t.ticketForm.recordId,time:t.ticketForm.time};t.$api.newly(i).then((function(e){var i=e.data;i.success?(r.reload(),r.$message({message:"创建话单成功！!",type:"success"})):t.$message({message:"创建话单失败!",type:"error"})}))}))},ticketAlter:function(e){var t=this,r=this;this.$refs[e].validate((function(e){if(!e)return!1;var i={phone:t.ticketForm.phone,caseName:t.ticketForm.case,desc:t.ticketForm.depict,flag:t.ticketForm.flag,id:t.ticketForm.id,recordId:t.ticketForm.recordId,time:t.ticketForm.time,name:t.ticketForm.name,accessToken:t.$Cookies.get("ac_token")};t.$api.ticketAlter(i).then((function(e){var i=e.data;i.success?(r.reload(),r.$message({message:"编辑话单成功！!",type:"success"})):t.$message({message:"编辑话单失败!",type:"error"})}))}))},ticketAddTo:function(e){var t=this,r=this;this.$refs[e].validate((function(e){if(!e)return!1;var i={phone:t.ticketForm.phone,caseName:t.ticketForm.case,desc:t.ticketForm.depict,flag:t.ticketForm.flag,id:t.ticketForm.id,recordId:t.ticketForm.recordId,time:t.ticketForm.time,name:t.ticketForm.name};t.$api.ticketAddTo(i).then((function(e){var i=e.data;i.success?(r.reload(),r.$message({message:"追加话单成功！!",type:"success"})):t.$message({message:"追加话单失败!",type:"error"})}))}))},resetForm:function(e){this.$refs[e].resetFields()},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,t){},handlePreview:function(e){},beforeUpload:function(e){var t="application/vnd.ms-excel"===e.type,r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type;return t|r},handleExceed:function(){this.$message.warning("当前限制选择 1 个文件，请删除后继续上传")},uploadError:function(){this.$message({message:"文件上传失败!",type:"error"})},uploadSuccess:function(e,t){this.ticketForm.uploadPhone=e.result,this.ticketForm.time=e.timestamp,this.ticketForm.recordId=t.uid,this.$message({message:"文件上传成功!",type:"success"})}}}),a=s,c=(r("c55c"),r("3fcc"),r("6691")),n=Object(c["a"])(a,i,o,!1,null,"4e153d7f",null);t["default"]=n.exports},c55c:function(e,t,r){"use strict";var i=r("7b06"),o=r.n(i);o.a},ffcd:function(e,t,r){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18739999"],{"02ea":function(e,t,i){},"133b":function(e,t,i){"use strict";var n=i("e7a1"),s=RegExp.prototype.exec,a=String.prototype.replace,o=s,r="lastIndex",d=function(){var e=/a/,t=/b*/g;return s.call(e,"a"),s.call(t,"a"),0!==e[r]||0!==t[r]}(),l=void 0!==/()??/.exec("")[1],c=d||l;c&&(o=function(e){var t,i,o,c,u=this;return l&&(i=new RegExp("^"+u.source+"$(?!\\s)",n.call(u))),d&&(t=u[r]),o=s.call(u,e),d&&o&&(u[r]=u.global?o.index+o[0].length:t),l&&o&&o.length>1&&a.call(o[0],i,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(o[c]=void 0)})),o}),e.exports=o},"1eb0":function(e,t,i){var n=i("a6ad"),s=i("3038");e.exports=function(e){return function(t,i){var a,o,r=String(s(t)),d=n(i),l=r.length;return d<0||d>=l?e?"":void 0:(a=r.charCodeAt(d),a<55296||a>56319||d+1===l||(o=r.charCodeAt(d+1))<56320||o>57343?e?r.charAt(d):a:e?r.slice(d,d+2):o-56320+(a-55296<<10)+65536)}}},2137:function(e,t,i){"use strict";var n=i("02f2"),s=RegExp.prototype.exec;e.exports=function(e,t){var i=e.exec;if("function"===typeof i){var a=i.call(e,t);if("object"!==typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(e,t)}},3171:function(e,t,i){},4633:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mod-relationAnalyse"},[e._m(0),n("div",{staticClass:"toolbox",attrs:{id:"toolPanel"}},[n("img",{staticClass:"toolbox-btn",attrs:{src:i("efe0"),alt:""}}),n("div",{staticClass:"tool-box",attrs:{id:"tool_btn_box"}},[e._m(1),n("div",[n("ul",{staticClass:"tool-btn-container"},[n("li",[n("a",{staticClass:"tool-btn-add",attrs:{href:"javascript:void(0);",id:"btnAddSearch"},on:{click:function(t){e.addSearchVisible=!e.addSearchVisible}}},[e._v("添加模型")])]),n("li",[n("a",{staticClass:"tool-btn",attrs:{href:"javascript:void(0);",id:"btnDataFillter"},on:{click:e.dataFillerHanlde}},[e._v("数据筛选")])]),n("li",[n("a",{staticClass:"tool-btn",attrs:{href:"javascript:void(0);",id:"btnImport"},on:{click:e.importHandle}},[e._v("导    入")])]),n("li",[n("a",{staticClass:"tool-btn",attrs:{href:"javascript:void(0);",id:"btnExport"},on:{click:e.exportHandle}},[e._v("导    出")])])])])])]),n("div",{staticClass:"searchbox",attrs:{id:"searchPanel"}},[n("div",[n("a",{staticClass:"btn btn-blue",attrs:{id:"btnReturnGxIndex",href:"javascript:void(0);"},on:{click:function(t){return e.$router.push({name:"relationSearch"})}}},[n("i",{staticClass:"el-icon-back elicon"}),e._v("返回")]),n("a",{staticClass:"btn btn-blue",attrs:{id:"btnClustering",href:"javascript:void(0);"},on:{click:e.clusteringHandle}},[n("i",{staticClass:"el-icon-share elicon"}),e._v("聚类切换")]),n("a",{staticClass:"btn btn-blue",attrs:{id:"btnMaster",href:"javascript:void(0);"},on:{click:e.masterHandle}},[n("i",{staticClass:"el-icon-news elicon"}),e._v("主要节点")]),n("div",{staticClass:"radarContainer"},[n("a",{staticClass:"btn btn-blue",attrs:{id:"btnSearch",href:"javascript:void(0);"},on:{click:e.radarHandle}},[n("i",{staticClass:"el-icon-news elicon"}),e._v("查询")]),n("div",{staticClass:"tc-div tc-shadow"},[e.cxVisble?n("el-select",{attrs:{size:"200",filterable:"",placeholder:"请选择"},on:{change:e.searchChangeHandle},model:{value:e.txtSearch,callback:function(t){e.txtSearch=t},expression:"txtSearch"}},e._l(e.allNodeOption,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],1)])])]),n("div",{staticClass:"contentMenu",staticStyle:{"z-index":"1000",display:"none",position:"absolute",width:"105px"},attrs:{id:"contextMenu"}},[e._m(2),"relationNode"==e.contextNodeType?n("ul",{staticClass:"menu_list"},[n("li",[n("a",{staticClass:"menu_item btn btn-blue",attrs:{href:"javascript:void(0);"},on:{click:e.addRelationHandle}},[e._v("添加关系")])]),n("li",[n("a",{staticClass:"menu_item btn btn-blue",attrs:{href:"javascript:void(0);"},on:{click:e.deleteItem}},[e._v("删除节点")])])]):"node"==e.contextNodeType?n("ul",{staticClass:"menu_list"},[n("li",[n("a",{staticClass:"menu_item btn btn-blue",attrs:{href:"javascript:void(0);"},on:{click:e.analysisHandle}},[e._v("关系挖掘")])]),n("li",[n("a",{staticClass:"menu_item btn btn-blue",attrs:{href:"javascript:void(0);"},on:{click:e.deleteItem}},[e._v("删除关系")])])]):e._e()]),n("fly-dialog",{staticClass:"custompos",attrs:{width:"400px",modal:!1,title:"添加模型",show:e.addSearchVisible},on:{"update:show":function(t){e.addSearchVisible=t},beforeCloseDialog:function(t){e.addSearchVisible=!1}}},[n("el-form",{ref:"dataForm",staticClass:"dataForm",attrs:{inline:!0,model:e.dataForm}},[n("el-form-item",[n("el-select",{attrs:{placeholder:"模型选择"},model:{value:e.dataForm.relationType,callback:function(t){e.$set(e.dataForm,"relationType",t)},expression:"dataForm.relationType"}},e._l(e.relationTypeList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.type}})})),1)],1),n("el-form-item",[n("el-input",{attrs:{placeholder:"输入身份证"},model:{value:e.dataForm.kws,callback:function(t){e.$set(e.dataForm,"kws",t)},expression:"dataForm.kws"}})],1),n("el-form-item",[n("el-button",{on:{click:function(t){return e.searchRelation()}}},[e._v("分析")])],1)],1)],1),n("fly-dialog",{staticClass:"custompos",attrs:{width:"400px",modal:!1,title:"数据筛选",show:e.fillterVisible},on:{"update:show":function(t){e.fillterVisible=t},beforeCloseDialog:function(t){e.fillterVisible=!1}}},[n("div",{attrs:{id:"sjsxForm"}},[n("el-form",{ref:"SJSXform",attrs:{model:e.SJSXform,"label-width":"100px"}},e._l(e.dataFillterTypeList,(function(t,i){return n("el-form-item",{key:i,attrs:{label:t.label}},[n("el-switch",{on:{change:function(i){return e.switchChange(t)}},model:{value:e.SJSXform[t.type.slice(0,-2)].switch,callback:function(i){e.$set(e.SJSXform[t.type.slice(0,-2)],"switch",i)},expression:"SJSXform[item.type.slice(0, -2)].switch"}}),n("el-slider",{staticClass:"myslider",attrs:{max:10},on:{change:function(i){return e.sliderChange(t)}},model:{value:e.SJSXform[t.type.slice(0,-2)].slider,callback:function(i){e.$set(e.SJSXform[t.type.slice(0,-2)],"slider",i)},expression:"SJSXform[item.type.slice(0, -2)].slider"}}),n("span",{staticClass:"num"},[e._v(e._s(e.SJSXform[t.type.slice(0,-2)].slider))])],1)})),1)],1)]),n("fly-dialog",{attrs:{id:"tjsx-dialog",width:"400px",title:"条件筛选",show:e.tjsxVisible},on:{"update:show":function(t){e.tjsxVisible=t},beforeCloseDialog:function(t){e.tjsxVisible=!1}}},[n("div",{staticClass:"container"},["SameTrain"===e.nodeType?n("header",[e._v("同旅馆次数")]):n("header",[e._v("只写了旅馆标题，其他的还没区分")]),n("el-form",{attrs:{"label-position":"left","label-width":"80px",model:e.TJSXForm}},[n("el-form-item",{attrs:{label:"证件号码"}},[n("el-input",{model:{value:e.TJSXForm.IDNum,callback:function(t){e.$set(e.TJSXForm,"IDNum",t)},expression:"TJSXForm.IDNum"}})],1),n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{model:{value:e.TJSXForm.userName,callback:function(t){e.$set(e.TJSXForm,"userName",t)},expression:"TJSXForm.userName"}})],1),"SameHotel"===e.nodeType?n("el-form-item",{attrs:{label:"旅馆名称"}},[n("el-input",{model:{value:e.TJSXForm.hotelName,callback:function(t){e.$set(e.TJSXForm,"hotelName",t)},expression:"TJSXForm.hotelName"}})],1):e._e(),"SameHotel"===e.nodeType?n("el-form-item",{attrs:{label:"旅馆编号"}},[n("el-input",{model:{value:e.TJSXForm.hotelID,callback:function(t){e.$set(e.TJSXForm,"hotelID",t)},expression:"TJSXForm.hotelID"}})],1):e._e(),"SameHotel"===e.nodeType?n("el-form-item",{attrs:{label:"旅馆地址"}},[n("el-input",{model:{value:e.TJSXForm.httelAddr,callback:function(t){e.$set(e.TJSXForm,"httelAddr",t)},expression:"TJSXForm.httelAddr"}})],1):e._e(),"SameHotel"===e.nodeType?n("el-form-item",{attrs:{label:"入住时间"}},[n("el-input",{model:{value:e.TJSXForm.checkIn,callback:function(t){e.$set(e.TJSXForm,"checkIn",t)},expression:"TJSXForm.checkIn"}})],1):e._e(),"SameHotel"===e.nodeType?n("el-form-item",{attrs:{label:"退房时间"}},[n("el-input",{model:{value:e.TJSXForm.checkOut,callback:function(t){e.$set(e.TJSXForm,"checkOut",t)},expression:"TJSXForm.checkOut"}})],1):e._e(),n("div",{staticClass:"submit-btn"},[n("el-button",{on:{click:function(t){return t.stopPropagation(),e.filterItem(t)}}},[e._v("查询")])],1)],1)],1)]),n("fly-dialog",{staticClass:"custompos",attrs:{width:"400px",title:"导入",show:e.importVisible},on:{"update:show":function(t){e.importVisible=t},beforeCloseDialog:function(t){e.importVisible=!1}}},[n("div",{staticClass:"importNode"},[n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-change":e.importHandleChange,"auto-upload":!1}},[n("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n          只能上传json文件，且不超过500kb\n        ")])],1)],1)]),e.detailVisible?n("details-info",{ref:"detailInfo"}):e._e(),e.analysisVisible?n("analysis",{ref:"analysis"}):e._e()],1)},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"netPanel"}},[i("div",{staticClass:"network",attrs:{id:"network_id"}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tool-title"},[i("span",[e._v("工具箱")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"menu_title"},[i("span",[e._v("操作")])])}],a=i("8e23"),o=a["a"],r=(i("9c86"),i("6691")),d=Object(r["a"])(o,n,s,!1,null,"69fe9fc4",null);t["default"]=d.exports},"6af6":function(e,t,i){"use strict";i("b3f3");var n=i("a6d5"),s=i("b8ea"),a=i("0cc1"),o=i("3038"),r=i("1277"),d=i("133b"),l=r("species"),c=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();e.exports=function(e,t,i){var h=r(e),f=!a((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=f?!a((function(){var t=!1,i=/a/;return i.exec=function(){return t=!0,null},"split"===e&&(i.constructor={},i.constructor[l]=function(){return i}),i[h](""),!t})):void 0;if(!f||!p||"replace"===e&&!c||"split"===e&&!u){var v=/./[h],m=i(o,h,""[e],(function(e,t,i,n,s){return t.exec===d?f&&!s?{done:!0,value:v.call(t,i,n)}:{done:!0,value:e.call(i,t,n)}:{done:!1}})),g=m[0],b=m[1];n(String.prototype,e,g),s(RegExp.prototype,h,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"8e23":function(e,t,i){"use strict";(function(e){i("e6d1"),i("7cfd");var n=i("e30b"),s=i("f5fb"),a=i.n(s),o=i("ecc0"),r=i.n(o),d=i("3fb8"),l=i("c021");t["a"]={components:{FlyDialog:n["a"],DetailsInfo:d["default"],Analysis:l["default"]},props:{},data:function(){return{addSearchVisible:!1,fillterVisible:!1,tjsxVisible:!1,detailVisible:!1,addRelationVisible:!1,analysisVisible:!1,cxVisble:!1,isClustering:!1,importVisible:!1,allRemoveItems:"",nodes:[],edges:[],container:null,nodesArray:[],edgesArray:[],options:{},data:{},contextNsId:null,contextNodeType:"",relationTypeList:[],xxNodecache:[],xxEdgecache:[],rmNodecache:[],rmEdgecache:[],rmSlidercache:[],batNodes:[],batedges:[],relationNodesTempArray:[],dataForm:{kws:"",relationType:""},nodeType:null,SJSXform:{SamePlane:{switch:!0,slider:0},SameTrain:{switch:!0,slider:0},SameHotel:{switch:!0,slider:0},SameRoom:{switch:!0,slider:0},SameCoach:{switch:!0,slider:0},SameInternetCafe:{switch:!0,slider:0},SameHousehold:{switch:!0,slider:0},SameCase:{switch:!0,slider:0},SamePrisonRoom:{switch:!0,slider:0},HaveDrivingLicense:{switch:!0,slider:0}},dataFillterTypeList:[],TJSXForm:{IDNum:null,userName:null,hotelName:null,hotelID:null,httelAddr:null,checkIn:null,checkOut:null,roomNo:null,computerNo:null,carNo:null}}},computed:{},methods:{importHandleChange:function(e){var t=this,i=(e.name,e.size,new FileReader);i.readAsText(e.raw),i.onload=function(){for(var e=JSON.parse(this.result),i=e.edges,n=e.nodes,s=0;s<n.length;s++)t.nodes.getIds().indexOf(n[s].id)<0&&t.nodes.add(n[s]);for(var a=0;a<i.length;a++)t.edges.getIds().indexOf(i[a].id)<0&&t.edges.add(i[a])}},startfn:function(){this.init(),this.queryData(this.$route.query)},queryData:function(e){var t=this;this.$api.aggregationAnalyse(e).then((function(e){var i=e.data;if(i&&200===i.code&&0===i.result.edges.length)t.$message({message:"没有相关模型！",type:"error",duration:1500});else{var n=i.result.nodes,s=i.result.edges,a=t.edges.getIds(),o=t.nodes.getIds(),r=[],d=[];for(var l in n)if(-1===o.indexOf(n[l].id))r.push(n[l]);else{n[l].id=n[l].id+"1";while(-1!==o.indexOf(n[l].id))n[l].id=n[l].id+"1";r.push(n[l])}for(var c in s)if(-1===a.indexOf(s[c].id)){-1===o.indexOf(s[c].to)&&-1===o.indexOf(s[c].from)?d.push(s[c]):-1!==o.indexOf(s[c].to)?(s[c].to=s[c].to+"1",d.push(s[c])):(s[c].from=s[c].from+"1",d.push(s[c]));while(-1!==o.indexOf(s[c].to))s[c].to=s[c].to+"1";while(-1!==o.indexOf(s[c].from))s[c].from=s[c].from+"1"}else{while(-1!==a.indexOf(s[c].id))s[c].id=s[c].id+"1",s[c].to=s[c].to+"1",s[c].from=s[c].from+"1";while(-1!==o.indexOf(s[c].to))s[c].to=s[c].to+"1";while(-1!==o.indexOf(s[c].from))s[c].from=s[c].from+"1";d.push(s[c])}for(var u in d){var h=d[u];-1===a.indexOf(h.id)?t.edges.add(h):t.edges.update(h)}t.addNodeToCanvas(r)}}))},addNodeToCanvas:function(e){var t=[],i=[],n=this.nodes.getIds();for(var s in e){var a=e[s];if(-1===n.indexOf(a.id))t.push(a);else{var o=this.nodes.get(a.id);o&&i.push(o)}}this.addOrUpdateNode(t),this.nodes.update(i)},addOrUpdateNode:function(e,t,i){var n={add:[],update:[]};for(var s in e instanceof Array||(e=[e]),e)if(-1===this.nodes.getIds().indexOf(e[s].id))n.add.push(e[s]);else if(!0===t){var a=this.nodes.get(e[s].id);a.merge(e[s]),n.update.push(e[a])}else n.update.push(e[s]);if(n.add.length>0&&this.nodes.add(n.add),n.update.length>0){if(!0===i){for(var o in n.update)void 0!==n.update[o].physics&&!0!==n.update[o].physics||(n.update[o].x=void 0,n.update[o].y=void 0,n.update[o].physics=!1,n.update[o].hiddenPhysics=!0);for(var r in this.nodes.update(n.update),n.update)!0===n.update[r].hiddenPhysics&&(n.update[r].physics=!0,n.update[r].hiddenPhysics=void 0)}this.nodes.update(n.update)}},init:function(){var e=this;e.nodes=new a.a.DataSet(e.nodesArray),e.edges=new a.a.DataSet(e.edgesArray),e.container=document.getElementById("network_id"),e.data={nodes:e.nodes,edges:e.edges},e.options={nodes:{shape:"dot",size:18,font:{color:"#ffffff"},borderWidth:2},edges:{font:{color:"#ffffff",strokeWidth:0},smooth:{type:"continuous"}},groups:{useDefaultGroups:!0},interaction:{hover:!0,navigationButtons:!1,multiselect:!0},manipulation:{enabled:!1},layout:{},physics:{maxVelocity:10,solver:"barnesHut",barnesHut:{avoidOverlap:0,centralGravity:.3,damping:.09,gravitationalConstant:-2e3,springConstant:.04,springLength:80},timestep:.5,stabilization:{enabled:!0,fit:!0,iterations:1e3,onlyDynamicEdges:!1,updateInterval:50}}},e.network=new a.a.Network(e.container,e.data,e.options),this.bindNetwork()},resetNetwork:function(){var e=[],t=[];this.nodes=new a.a.DataSet(e),this.edges=new a.a.DataSet(t),this.data={nodes:this.nodes,edges:this.edges},this.network&&this.network.destroy(),this.network=new a.a.Network(this.container,this.data,this.options),this.bindNetwork()},bindNetwork:function(){this.network.on("doubleClick",this.doubleClick),this.network.on("click",this.clickEvent),this.network.on("hoverNode",this.hoverEvent),this.network.on("blurNode",this.blurEvent),this.network.on("dragStart",this.dragStartEvent),this.network.on("dragEnd",this.dragEndEvent),this.network.on("oncontext",this.oncontextEvent)},doubleClick:function(e){if(0===e.nodes.length)return!1;var t=this.nodes.get(e.nodes[0]);"RN"===t.nodeType.substring(t.nodeType.length-2)&&(this.nodeType=t.nodeType.substring(0,t.nodeType.length-2))},clickEvent:function(e){if(this.removeContextMenu(),1===e.nodes.length);else if(1===e.edges.length){var t=this.edges.get(e.edges[0]);"RelationEdge"===t.relationType||(this.detailVisible=!0,this.getDetails(t))}},hoverEvent:function(e){this.contextNsId=e.node},blurEvent:function(e){this.contextNsId=null},dragStartEvent:function(e){if(e.nodes&&e.nodes.length>0){var t=this.nodes.get(e.nodes[0]);t.x=void 0,t.y=void 0,t.physics=!1,this.nodes.update(t)}},dragEndEvent:function(e){if(e.nodes&&e.nodes.length>0){var t=this.nodes.get(e.nodes[0]),i=this.network.getPositions([t.id]);t.x=i[t.id].x,t.y=i[t.id].y,this.nodes.update(t)}},oncontextEvent:function(e){if(e.event.returnValue=!1,this.removeContextMenu(),null==this.contextNsId)return!1;this.showContextMenu(this.contextNsId,e)},showContextMenu:function(e,t){var i=e,n=this.nodes.get(i);this.showMenu(t),"RN"===n.nodeType.substring(n.nodeType.length-2)?this.contextNodeType="relationNode":this.contextNodeType="node"},showMenu:function(t){e("#contextMenu").css({left:t.event.clientX}),e("#contextMenu").css({top:t.event.clientY}),e("#contextMenu").css({display:"block"})},removeContextMenu:function(){e("#contextMenu").css({display:"none"})},getDetails:function(e){var t=this,i={idsJson:e.idArr,relationType:e.relationType};this.$api.compareAnalyse(i).then((function(i){var n=i.data;n&&200===n.code&&t.$nextTick((function(){t.$refs.detailInfo.init(n.result,e.relationType)}))}))},importHandle:function(){this.importVisible=!0},exportHandle:function(){if(!this.hasData())return this.$message({message:"没有可以导出的数据！",type:"error",duration:1500}),!1;this.exportJson()},dataFillerHanlde:function(){this.fillterVisible=!this.fillterVisible;var e=this.getAllNodes(),t=this.getAllNodes(),i=this.getAllEdges();this.batedges=i,this.batNodes=t;var n=e.filter((function(e){if("RN"===e.nodeType.substring(e.nodeType.length-2))return e})),s=n.map((function(e){return e.nodeType}));for(var a in s)this.disRepeat(this.dataFillterTypeList,s[a])||this.dataFillterTypeList.push({type:s[a],label:this.initLabel(s[a])})},switchChange:function(e){if(this.SJSXform[e.type.slice(0,-2)].switch)for(var t in this.rmNodecache)this.rmNodecache[t].type===e.type&&(this.addNode(this.rmNodecache[t].node),this.rmNodecache[t]={node:"",type:""});else this.hiddenNode(e.type)},sliderChange:function(e){var t=[];for(var i in this.SJSXform){var n=this.hiddenNodeByNum(i+"RN",this.SJSXform[i].slider);t=t.concat(n)}this.removeNode(t)},hiddenNodeByNum:function(e,t){var i=this.batNodes.filter((function(t){if(t.nodeType==e)return t})),n=[];for(var s in i){var a=this.findChildsBytpIdAndNum(i[s].id,t);for(var o in a)n.push(a[o])}return n},removeNode:function(e){var t=[],i=this.batNodes.map((function(e){return e.id}));for(var n in i)this.existsId(e,i[n])||t.push(i[n]);var s=[];for(var a in t)for(var o in this.batNodes)t[a]==parseInt(this.batNodes[o].id)&&s.push(this.batNodes[o]);this.resetNetwork(),this.nodes.add(s),this.edges.add(this.batedges)},hiddenNode:function(e){var t=this.getAllNodes(),i=t.filter((function(t){if(t.nodeType==e)return t})),n=[];for(var s in i){var a=this.findChildsBytpId(i[s].id);for(var o in n.push(i[s].id),a)n.push(a[o])}var r=[];for(var d in n)r.push(this.nodes.get(n[d])),this.nodes.remove(n[d]);this.rmNodecache.push({node:r,type:e})},findChildsBytpIdAndNum:function(e,t){var i=this.batedges,n=[];for(var s in i)i[s].to===e&&parseInt(i[s].label)<=parseInt(t)&&n.push(i[s].from);return this.findChildsBytpId(e).length==n.length&&n.push(e),n},findChildsBytpId:function(e){var t=this.getAllEdges(),i=[];for(var n in t)t[n].to===e&&i.push(t[n].from);return i},disRepeat:function(e,t){var i=!1;return e.map((function(e){e.type===t&&(i=!0)})),i},initLabel:function(e){e=e.slice(0,-2);var t="";switch(e){case"SameHotel":t="同旅馆";break;case"SameRoom":t="同房间";break;case"SamePlane":t="同飞机";break;case"SameTrain":t="同火车";break;case"SameCoach":t="同汽车";break;case"SameInternetCafe":t="同网吧";break;case"SameHousehold":t="同户";break;case"SameCase":t="同案";break;case"SamePrisonRoom":t="同监室";break;case"HaveCar":t="拥有车";break;case"HaveDrivingLicense":t="驾照";break}return t},handleChange:function(e){},convertArray:function(e){e.nodes.filter((function(e){return"342128196203036214"!==e.keyword}));var t=this.buildRelationNode("同火车"),i=e.nodes.map((function(e){return e.id})),n=this.buildsEdgs(i,t);return{nodes:e.nodes.concat(t),edges:n}},buildsEdgs:function(e,t){var i=[];for(var n in e){var s={id:n,to:t[0].id,from:e[n]};i.push(s)}return i},buildRelationNode:function(e){return[{id:2,label:e,nodeType:"Relation"}]},searchRelation:function(){var e={keyword:this.dataForm.kws,relationType:[this.dataForm.relationType]};this.queryData(e)},addRelationHandle:function(){this.addRelationVisible=!0,this.removeContextMenu()},analysisHandle:function(){var e=this;this.analysisVisible=!0;var t=this.getCurrentNode();this.removeContextMenu(),this.$nextTick((function(){e.$refs.analysis.init(t,e.nodes,e.edges)}))},getCurrentNode:function(){return this.nodes.get(this.contextNsId)},clusteringHandle:function(){if(!this.hasData())return this.$message({message:"没有关系数据！",type:"error",duration:1500}),!1;this.isClustering=!this.isClustering,this.isClustering?this.countNodeFun():this.disCountNodeFun()},masterHandle:function(){if(!this.hasData())return this.$message({message:"没有关系数据！",type:"error",duration:1500}),!1;this.xxNodecache&&this.xxNodecache.length>0?this.discoverNode():this.coverNode()},coverNode:function(){var e=this.network.getSelectedNodes();if(!e||e.length<2)return this.$message({message:"请使用Ctrl+鼠标左键选择多个节点后再执行此操作!",type:"error",duration:1500}),!1;var t=this.getRelationPaths(e);if(0===t.length)return this.$message({message:"没有找到相连路径!",type:"error",duration:1500}),!1;var i=[],n=[];for(var s in t)for(var a in t[s]){var o=t[s][a];for(var r in o.nodes){var d=o.nodes[r];this.existsId(i,d)||i.push(d)}for(var l in o.edges){var c=o.edges[l];this.existsId(n,c)||n.push(c)}}var u=this.nodes.getIds();for(var h in u)this.existsId(i,u[h])||(this.xxNodecache.push(this.nodes.get(u[h])),this.nodes.remove(u[h]));var f=this.edges.getIds();for(var p in f)this.existsId(n,f[p])||(this.xxEdgecache.push(this.edges.get(f[p])),this.edges.remove(f[p]));return!0},discoverNode:function(){this.addNode(this.xxNodecache),this.addEdge(this.xxEdgecache),this.xxNodecache=[],this.xxEdgecache=[]},addNode:function(e){var t={add:[],update:[]};for(var i in e instanceof Array||(e=[e]),e)if(-1===this.nodes.getIds().indexOf(e[i].id))t.add.push(e[i]);else{var n=this.nodes.get(e[i].id);t.update.push(n)}t.add.length>0&&this.nodes.add(t.add),t.update.length>0&&this.nodes.update(t.update)},addEdge:function(e){var t={add:[],update:[]};for(var i in e instanceof Array||(e=[e]),e){var n=e[i];if(this.getEdgeConnecting(n.from,n.to)){var s=this.edges.get({filter:function(e){return e.from==n.from&&e.to==n.to}})[0];s.merge(n),s.updateLabel(),s.updateWidth(),t.update.push(n)}else t.add.push(n)}t.add.length>0&&this.edges.add(t.add),t.update.length>0&&this.edges.update(t.update)},getRelationPaths:function(e){for(var t=[],i=0;i<e.length;i++)for(var n=i+1;n<e.length;n++){var s=this.getRelationNodes(e[i],e[n]);if(this.relationNodesTempArray=[],0===s.length)return t;t.push(s)}return t},getRelationNodes:function(e,t,i){i||(i=","),i+=e+",";var n=[],s=this.network.getConnectedEdges(e);if(!s||0===s.length)return n;for(var a in s){var o,r=this.edges.get(s[a]);if(o=r.from===e?r.to:r.from,-1===i.indexOf(","+o+","))if(o===t){var d=(i+t).split(","),l=!0;for(var c in d)this.existsId(this.relationNodesTempArray,d[c])||(this.relationNodesTempArray.push(d[c]),l=!1);if(!l){var u={nodes:d,edges:this.getTraceBackEdges(d)};n.push(u)}}else{var h=i,f=this.getRelationNodes(o,t,h);for(var p in f)n.push(f[p])}}return n},getTraceBackEdges:function(e){e.reverse();for(var t=[],i=0;i<e.length-1;i++){var n=this.getEdgeConnecting(e[i],e[i+1]);n?t.push(n):t.push(this.getEdgeConnecting(e[i+1],e[i]))}return t},getEdgeConnecting:function(e,t){var i=this.getAllEdges().filter((function(i){if(i.from==e&&i.to==t)return i}))[0];if(i instanceof Object)return i.id},existsId:function(e,t){var i=!1;for(var n in e)parseInt(e[n])===t&&(i=!0);return i},disCountNodeFun:function(){this.resetNetwork();var e=JSON.parse(sessionStorage.getItem("nodes")||"[]"),t=JSON.parse(sessionStorage.getItem("edges")||"[]");this.nodes.add(e),this.edges.add(t)},countNodeFun:function(){var e=this;sessionStorage.setItem("nodes",JSON.stringify(this.getAllNodes())),sessionStorage.setItem("edges",JSON.stringify(this.getAllEdges()));var t=this.findRelationNodes();if(t&&0!==t.length){var i=[],n=[],s=this.getAllEdges(),a=function(a){var o=s.filter((function(e){return t[a].id===e.to})),r=s.filter((function(e){return t[a].id===e.from})),d=e.buildNodes(r,o),l=e.buildEdges(r,o);i=i.concat(d),n=n.concat(l)};for(var o in t)a(o);var r=i.map((function(e,t){return e.id}));r=r.filter((function(e,t){return r.indexOf(e)==t})),i=r.map((function(t){return e.nodes.get(t)})),this.resetNetwork(),this.rendNode(i,n)}},rendNode:function(e,t){this.nodes.add(e),this.edges.add(t)},buildNodes:function(e,t){var i=this,n=[this.nodes.get(e[0].to)],s=t.map((function(e){return i.nodes.get(e.from)}));return n.concat(s)},buildEdges:function(e,t){var i=e[0].to,n=e[0].label,s=t.map((function(e){return e.to=i,e.label=n+"("+e.label+")",e}));return s},findRelationNodes:function(){var e=this.getAllNodes().filter((function(e){if("RN"===e.nodeType.substring(e.nodeType.length-2))return e}));return e},findChilds:function(){},radarHandle:function(){this.cxVisble=!this.cxVisble,this.buildeRadarItem()},buildeRadarItem:function(){var e=this.getAllNodes(),t=[];for(var i in e){var n=e[i];"RN"!==n.nodeType.substring(n.nodeType.length-2)&&t.push({value:n.id,label:n.label})}this.allNodeOption=t},searchChangeHandle:function(e){this.focusNode(e)},getAllNodes:function(){var e=[];if(this.nodes){var t=this.nodes.getIds();for(var i in t)e.push(this.nodes.get(t[i]))}return e},getAllEdges:function(){var e=[];if(this.edges){var t=this.edges.getIds();for(var i in t)e.push(this.edges.get(t[i]))}return e},deleteItem:function(){var e=this.getCurrentNode();this.removeContextMenu(),this.nodes.remove(e.id)},focusNode:function(e){var t={scale:1.5,offset:{x:0,y:0},animation:{duration:1e3,easingFunction:"easeInOutQuad"}};this.network.focus(e,t),this.network.selectNodes([e],!1)},hasData:function(){return!!(this.nodes&&this.nodes.length>0)},filterItem:function(){},exportJson:function(){var e=this.buildExportData(),t=new Blob([JSON.stringify(e)]);r.a.saveAs(t,"relation.json")},buildExportData:function(){var e=[],t=this.nodes.getIds();for(var i in t){var n=this.nodes.get(t[i]);e.push(n)}var s=this.edges.getIds(),a=[];for(var o in s){var r=this.edges.get(s[o]);a.push(r)}return{nodes:e,edges:a}}},created:function(){var e=this;this.$api.getAllRelationType().then((function(t){var i=t.data;i&&200===i.code&&(e.relationTypeList=i.result.map((function(e){return{type:e.type,name:e.name}})))}))},mounted:function(){this.startfn()}}}).call(this,i("debc"))},"9c86":function(e,t,i){"use strict";var n=i("02ea"),s=i.n(n);s.a},ac60:function(e,t,i){"use strict";var n=i("3171"),s=i.n(n);s.a},b3f3:function(e,t,i){"use strict";var n=i("133b");i("2498")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},c021:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("fly-dialog",{attrs:{title:"关系挖掘",width:"600px",show:e.visible},on:{"update:show":function(t){e.visible=t},beforeCloseDialog:e.beforeClose}},[i("div",{staticClass:"mode-add-update"},[i("p",{staticClass:"info_item"},[i("label",{staticClass:"kws"},[e._v(e._s(e.dataForm.label))]),e._v(e._s(e.dataForm.keyword)+"\n      "),i("span",{staticClass:"da"},[e._v("查看档案")])]),i("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[i("el-form-item",{attrs:{label:"关系类型"}},[i("el-checkbox-group",{model:{value:e.dataForm.checkList,callback:function(t){e.$set(e.dataForm,"checkList",t)},expression:"dataForm.checkList"}},e._l(e.relationTypeList,(function(t,n){return i("el-checkbox",{key:n,attrs:{label:t.type}},[e._v(e._s(t.name))])})),1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"ft"},slot:"ft"},[i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)])},s=[],a=(i("7cfd"),i("e30b")),o={components:{FlyDialog:a["a"]},props:{},data:function(){return{visible:!1,curNode:[],nodes:[],edges:[],relationTypeList:[],dataForm:{checkList:[],label:"",keyword:""},dataRule:{}}},computed:{},methods:{init:function(e,t,i){var n=this;this.curNode=e,this.dataForm.label=e.label,this.dataForm.keyword=e.keyword,this.nodes=t,this.edges=i,this.$api.getAllRelationType().then((function(e){var t=e.data;t&&200===t.code&&(n.relationTypeList=t.result.map((function(e){return{type:e.type,name:e.name}})))})).then((function(){n.visible=!0}))},dataFormSubmit:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var i={keyword:e.curNode.keyword,param:e.dataForm.checkList.join(",")};e.$api.nodeDigRelation(i).then((function(t){var i=t.data;if(i&&200===i.code){if(!i.result.nodes||0===i.result.nodes.length)return e.$message({message:"没有查询到关系数据！",type:"error",duration:1500}),!1;for(var n=i.result.edges,s=i.result.nodes,a=0;a<s.length;a++)e.nodes.getIds().indexOf(s[a].id)<0&&e.nodes.add(s[a]);for(var o=0;o<n.length;o++)e.edges.getIds().indexOf(n[o].id)<0&&e.edges.add(n[o]);e.dataForm.checkList=[]}}))}}))},saveOrUpdateGx:function(){},beforeClose:function(){this.$emit("refreshDataList"),this.visible=!1}},created:function(){},mounted:function(){}},r=o,d=(i("ac60"),i("6691")),l=Object(d["a"])(r,n,s,!1,null,"3132d17f",null);t["default"]=l.exports},e6d1:function(e,t,i){"use strict";var n=i("5f9c"),s=i("8cac"),a=i("95e3"),o=i("ff04"),r=i("8941"),d=i("2137"),l=i("133b"),c=i("0cc1"),u=Math.min,h=[].push,f="split",p="length",v="lastIndex",m=4294967295,g=!c((function(){RegExp(m,"y")}));i("6af6")("split",2,(function(e,t,i,c){var b;return b="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[p]||2!="ab"[f](/(?:ab)*/)[p]||4!="."[f](/(.?)(.?)/)[p]||"."[f](/()()/)[p]>1||""[f](/.?/)[p]?function(e,t){var s=String(this);if(void 0===e&&0===t)return[];if(!n(e))return i.call(s,e,t);var a,o,r,d=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,f=void 0===t?m:t>>>0,g=new RegExp(e.source,c+"g");while(a=l.call(g,s)){if(o=g[v],o>u&&(d.push(s.slice(u,a.index)),a[p]>1&&a.index<s[p]&&h.apply(d,a.slice(1)),r=a[0][p],u=o,d[p]>=f))break;g[v]===a.index&&g[v]++}return u===s[p]?!r&&g.test("")||d.push(""):d.push(s.slice(u)),d[p]>f?d.slice(0,f):d}:"0"[f](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,n){var s=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,s,n):b.call(String(s),i,n)},function(e,t){var n=c(b,e,this,t,b!==i);if(n.done)return n.value;var l=s(e),h=String(this),f=a(l,RegExp),p=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(g?"y":"g"),y=new f(g?l:"^(?:"+l.source+")",v),x=void 0===t?m:t>>>0;if(0===x)return[];if(0===h.length)return null===d(y,h)?[h]:[];var N=0,k=0,w=[];while(k<h.length){y.lastIndex=g?k:0;var S,C=d(y,g?h:h.slice(k));if(null===C||(S=u(r(y.lastIndex+(g?0:k)),h.length))===N)k=o(h,k,p);else{if(w.push(h.slice(N,k)),w.length===x)return w;for(var I=1;I<=C.length-1;I++)if(w.push(C[I]),w.length===x)return w;k=N=S}}return w.push(h.slice(N)),w}]}))},efe0:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAhCAYAAAC803lsAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4ZTQwNzZkZi0yOGI4LTMxNDQtYjU0MS00YmU0MzQxNGI4ZTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTU5QzRFN0Q0OUI3MTFFNkI5MTVEODBDMzE5OEM5N0QiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTU5QzRFN0M0OUI3MTFFNkI5MTVEODBDMzE5OEM5N0QiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmI3MTVmYWZhLWYxZmUtYjE0Zi05YzA1LWRmMzQ2YjMxMjdkNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4ZTQwNzZkZi0yOGI4LTMxNDQtYjU0MS00YmU0MzQxNGI4ZTMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz44KI08AAADcklEQVR42uyXW0sbQRiGJzEeIhpBPFw0EEsvRPAHBNP8BOltsPSiFCmoeALBmzZJ/0al4EVMPCAuJSXQ3ElKb8oGeiPFBMVDYoymGnMwHtL3G3ZFxLiduAULDrzsZJPMPPN+33yzayiXy+whNCN7IO1hgxgMBi4KW5UyQ15oHSpAr9UxVQk5UiVE4+XlZRh6j/6zQCDww2g02jHccyY6mdouLi6EdXZ29gEqk2ZmZmQM8wl6oTWv7o7AiQGIrgRGq5IU8XZ6evpG2JFSqSSsQqFQhMqqwuGwXx0Pn91QCV3nzTkNt9URNZlAL5T5ihNxdJ8SVF1dHb8fiUQCDodjDV0PQPba2to+Y97B6/81aQ0sAoFQuAmC+ufn51z19fXMbre7KH9ogcvLywn8JnPz/yatHPmbpiQqQXiUELDa2lougiIA7BwWi8VSU1NTP/GTb7pvX+wOyg03QDwElM1meUgI4uTkJF9TU1M+PDzMzs3NRZ1OZ+jo6IhC9EXIEa3QKPZfOYGJWVNTE1+9z+eTh4aGorj9G7JAaei7AlHSLTTkBHQFQU40NzdzCKxeHh4ejt7cune1qhxRw6FCwG7W0tLCEAbm9/vlkZERIYiqcoS2dLFYdAPSQ6AHBwfcCZPJxFDOryAymYwksvWFHCEIOEEukBsMSchaW1s5xPz8vDw6OsohACeJbH1NEKych4EGpdiTCypEOp1mKEx8dywsLMhjY2McAvelah62KoLE43FzPp+fRvcl9ARbcw9XG323v7/P2tvbOcTi4qI8Pj7OIVKplLATd4JsbGw0wo2v6PZdu22j0FBidnR0cIilpSV5YmKCQySTyaohKoIAYhqD9pnNZvWwYpiI9y0WC7+iVMuTk5McIpFISPd99jVWKNkDdEasrKxESdQnF6hyNjQ00E7JqRC7u7tSpap7b0fghDUUCkVg+y+arKury9Xb2+vq7OzkiYvtSlZldnZ2JL3eAm4FwVnxFuXZgW5we3ubF6bV1VXW09PjUkKXoyjp+SpyK4jVap3FZX1raytCk+VyOdbd3b1GblCS4vkiRo78cxClcQiqJQBxo3x7KFeQtCmv18uPcj1BNEs8Jh9E4XqHcCWDwWC0v78/dHx8zI9yrUcE3Sqr0j7abDZK2lfXj/LNzc2Sni9Yhsd330eQ/wXkjwADAOSTb1sNIKChAAAAAElFTkSuQmCC"},ff04:function(e,t,i){"use strict";var n=i("1eb0")(!0);e.exports=function(e,t,i){return t+(i?n(e,t).length:1)}}}]);